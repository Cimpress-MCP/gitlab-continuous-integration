#To use this you will need buildcomponents.yaml in your top level ci file. 

build:
  extends: .migrate
  stage: build
  services:
    - $POSTGRES_VERSION
  after_script:
    - npm test
  coverage: '/All files\s*\|\s*[.?\d]+\s*\|\s*([0-9.]+)/'
  artifacts:
    paths:
      - coverage/
  variables:
    POSTGRES_VERSION: postgres:10.6-alpine
    POSTGRES_DB: postgres
    POSTGRES_USER: postgres
    POSTGRES_SERVER: postgres
    POSTGRES_PASSWORD: ''